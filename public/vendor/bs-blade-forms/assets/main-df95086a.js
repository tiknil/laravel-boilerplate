var v=Object.defineProperty;var f=(l,e,t)=>e in l?v(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var s=(l,e,t)=>(f(l,typeof e!="symbol"?e+"":e,t),t);let a=0;const m=(l,e)=>(...t)=>{clearTimeout(a),a=setTimeout(()=>l(...t),e)};let d=null,h=0;const y=(l,e)=>(...t)=>{d===null?(l(...t),d=Date.now()):(clearTimeout(h),h=setTimeout(()=>{Date.now()-d>=e&&(l(...t),d=Date.now())},e-(Date.now()-d)))};class p{constructor(e,t){s(this,"rootEl");s(this,"multiple");s(this,"dropdown");s(this,"dropdownOptions",new Map);s(this,"optionsSearchText",new Map);s(this,"dropdownSearch");s(this,"dropdownSelectAllBtn",null);s(this,"dropdownUnselectAllBtn",null);s(this,"uiBox");s(this,"placeholder");s(this,"valueLabel");s(this,"select");s(this,"current");s(this,"active",null);s(this,"isOpen",!1);s(this,"calcCurrent",()=>this.multiple?Array.from(this.select.selectedOptions).map(e=>e.value):this.select.value);s(this,"init",()=>{var e,t,n,o;this.populateDropdown();for(const[i,r]of this.dropdownOptions)r.addEventListener("mousemove",y(c=>i!==this.active?this.setActive(i):null,25));this.uiBox.addEventListener("click",()=>this.toggle()),document.addEventListener("click",i=>{this.rootEl.contains(i.target)||this.close(!1)}),document.addEventListener("keyup",i=>{i.key==="Escape"&&this.close(!1)}),document.addEventListener("keydown",i=>{i.key===" "&&this.uiBox===document.activeElement&&this.toggle(),this.isOpen&&this.active!==null&&i.key==="Enter"&&this.onOptionSelected(this.active),this.isOpen&&this.active!==null&&i.key==="ArrowDown"&&this.moveActiveDown(),this.isOpen&&this.active!==null&&i.key==="ArrowUp"&&this.moveActiveUp()}),(e=this.dropdownSearch)==null||e.addEventListener("input",m(i=>this.search(),250)),(t=this.dropdownSearch)==null||t.addEventListener("keydown",i=>{i.key==="Enter"&&i.preventDefault()}),this.dropdown.addEventListener("click",i=>{const r=i.target;if(r.classList.contains("ss-remove-icon")){this.onOptionSelected(this.emptyValue);return}const c=r.closest(".ss-option");c!==null&&this.onOptionSelected(c.getAttribute("data-key"))}),this.select.addEventListener("change",this.update),(n=this.dropdownSelectAllBtn)==null||n.addEventListener("click",i=>this.setAll(!0)),(o=this.dropdownUnselectAllBtn)==null||o.addEventListener("click",i=>this.setAll(!1)),this.update(),this.initLivewire()});s(this,"initLivewire",()=>{if(!this.rootEl.hasAttribute("data-livewire")){window.Livewire&&console.info("[SearchSelect] Be sure to include the livewire attribute when rendering inside a Livewire component");return}if(!window.Livewire){console.error("MISSING LIVEWIRE GLOBAL OBJECT!");return}window.Livewire.hook("morph.updated",({el:t})=>this.onLivewireUpdate(t)),window.Livewire.hook("element.init",({el:t})=>setTimeout(()=>this.onLivewireUpdate(t),50))});s(this,"open",()=>{this.isOpen=!0,this.dropdown.classList.remove("hidden"),setTimeout(()=>{var e;return(e=this.dropdownSearch)==null?void 0:e.focus()},25),this.setActive(this.dropdownOptions.keys().next().value)});s(this,"close",(e=!0)=>{this.isOpen=!1,this.dropdown.classList.add("hidden"),this.dropdownSearch&&(this.dropdownSearch.value="",this.dropdownSearch.dispatchEvent(new Event("input"))),e&&this.uiBox.focus()});s(this,"toggle",()=>{this.isOpen?this.close():this.open()});s(this,"search",()=>{var i;if(!this.dropdownSearch)return;let e=this.dropdownSearch.value.toLowerCase().trim();e.length<2&&(e="");let t=null;const n=[],o=[];for(const[r,c]of this.dropdownOptions)e===""||((i=this.optionsSearchText.get(r))==null?void 0:i.includes(e))?(c.classList.contains("hidden")&&n.push(c),t===null&&(t=r)):c.classList.contains("hidden")||o.push(c);requestAnimationFrame(()=>{n.forEach(r=>r.classList.remove("hidden")),o.forEach(r=>r.classList.add("hidden")),this.setActive(t)})});s(this,"populateDropdown",()=>{const e=new Set(this.dropdownOptions.keys()),t=this.rootEl.querySelector(".ss-option-template"),n=this.dropdown.querySelector(".ss-options");this.select.querySelectorAll("option").forEach(o=>{if(o.value===this.emptyValue)return;if(this.dropdownOptions.has(o.value)){e.delete(o.value),this.dropdownOptions.get(o.value).querySelector("span").innerText=o.innerText;return}const i=t.content.cloneNode(!0).firstElementChild;i.setAttribute("data-key",o.value),i.querySelector("span").innerText=o.label,n.appendChild(i),this.dropdownOptions.set(o.value,i),this.optionsSearchText.set(o.value,o.label.toLowerCase())}),e.forEach(o=>{var i;(i=this.dropdownOptions.get(o))==null||i.remove(),this.dropdownOptions.delete(o),this.optionsSearchText.delete(o)})});s(this,"onOptionSelected",e=>{if(e==null&&(e=this.emptyValue),this.multiple){for(const t of this.select.options)if(t.value===e){t.selected=!t.selected;break}}else this.select.value=e;this.select.dispatchEvent(new Event("change")),this.multiple||this.close()});s(this,"setAll",e=>{var t;for(const n of this.select.options){const o=n.value.trim();n.selected=(t=this.dropdownOptions.get(o))!=null&&t.classList.contains("hidden")?n.selected:e}this.select.dispatchEvent(new Event("change"))});s(this,"setActive",e=>{var t,n,o;e!==this.active&&(this.active!==null&&((t=this.dropdownOptions.get(this.active))==null||t.classList.remove("active")),e!==null&&((n=this.dropdownOptions.get(e))==null||n.classList.add("active"),(o=this.dropdownOptions.get(e))==null||o.scrollIntoView({block:"nearest",behavior:"smooth"})),this.active=e)});s(this,"moveActiveDown",()=>{let e=!1;for(const t of this.dropdownOptions.keys()){if(e){this.setActive(t);break}t===this.active&&(e=!0)}});s(this,"moveActiveUp",()=>{let e=null;for(const t of this.dropdownOptions.keys()){if(t===this.active){e&&this.setActive(e);break}e=t}});s(this,"update",()=>{this.multiple?this.updateMultiple():this.updateSingle()});s(this,"updateMultiple",()=>{this.current=this.calcCurrent();const e=[];for(const[t,n]of this.dropdownOptions)this.current.includes(t)?(n.classList.add("selected"),e.push(n.innerText.trim())):n.classList.remove("selected");e.length>0?(this.valueLabel.innerHTML=e.join(", "),this.valueLabel.style.display="block",this.placeholder.style.display="none"):(this.placeholder.style.display="block",this.valueLabel.style.display="none")});s(this,"updateSingle",()=>{this.current=this.calcCurrent(),this.dropdown.querySelectorAll(".ss-option.selected").forEach(t=>t.classList.remove("selected"));let e="";if(this.current!==this.emptyValue){const t=this.dropdownOptions.get(this.current);t&&(t.classList.add("selected"),e=t.innerText??"")}e!==""?(this.valueLabel.innerHTML=e,this.valueLabel.style.display="block",this.placeholder.style.display="none"):(this.placeholder.style.display="block",this.valueLabel.style.display="none")});this.multiple=t,this.rootEl=e,this.dropdown=e.querySelector(".ss-dropdown"),this.dropdownSearch=this.dropdown.querySelector(".ss-dropdown-search input"),this.dropdownSelectAllBtn=this.dropdown.querySelector(".ss-dropdown-search .ss-select-all"),this.dropdownUnselectAllBtn=this.dropdown.querySelector(".ss-dropdown-search .ss-unselect-all"),this.uiBox=e.querySelector(".ss-box"),this.placeholder=this.uiBox.querySelector(".ss-placeholder"),this.valueLabel=this.uiBox.querySelector(".ss-value-label"),this.select=e.querySelector(".ss-ghost-select"),this.current=this.calcCurrent(),this.init()}get emptyValue(){return this.multiple?"":this.select.firstElementChild.value}onLivewireUpdate(e){e===this.select&&(JSON.stringify(this.current)!==JSON.stringify(this.calcCurrent())&&this.update(),setTimeout(()=>this.populateDropdown(),50))}}class u extends p{constructor(e){super(e,!1)}}class w extends p{constructor(e){super(e,!0)}}document.querySelectorAll("div.ss-wrapper").forEach(l=>new u(l));document.querySelectorAll("div.ms-wrapper").forEach(l=>new w(l));const S=new MutationObserver(function(l){l.forEach(function(e){e.addedNodes.forEach(function(t){t.nodeType===1&&(t.querySelectorAll("div.ss-wrapper").forEach(n=>new u(n)),t.querySelectorAll("div.ms-wrapper").forEach(n=>new w(n)))})})});S.observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1});
